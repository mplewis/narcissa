/*! squel | https://github.com/hiddentao/squel | BSD license */(function(){var a,b,c,d,e,f,g,h,i,j,k,l=[].slice,m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a={},e=function(){var a,b,c,d,e,f,g;if(a=arguments[0],c=2<=arguments.length?l.call(arguments,1):[])for(f=0,g=c.length;g>f;f++)if(d=c[f])for(b in d)m.call(d,b)&&(e=d[b],a[b]=e);return a},k=function(){var a,b,c,d,f,g;for(b=arguments[0],d=2<=arguments.length?l.call(arguments,1):[],a=e({},b),f=0,g=d.length;g>f;f++)c=d[f],delete a[c];return a},a.DefaultQueryBuilderOptions={autoQuoteTableNames:!1,autoQuoteFieldNames:!1,autoQuoteAliasNames:!0,nameQuoteCharacter:"`",tableAliasQuoteCharacter:"`",fieldAliasQuoteCharacter:'"',valueHandlers:[],numberedParameters:!1,replaceSingleQuotes:!1,singleQuoteReplacement:"''",separator:" "},a.globalValueHandlers=[],c=function(a,b,c){var d,e,f;if("function"!=typeof b)throw new Error("type must be a class constructor");if("function"!=typeof c)throw new Error("handler must be a function");for(e=0,f=a.length;f>e;e++)if(d=a[e],d.type===b)return void(d.handler=c);return a.push({type:b,handler:c})},b=function(){var a,b,c,d,e,f,g,h;for(d=arguments[0],a=2<=arguments.length?l.call(arguments,1):[],e=0,g=a.length;g>e;e++)for(b=a[e],f=0,h=b.length;h>f;f++)if(c=b[f],d instanceof c.type)return c.handler;return void 0},a.registerValueHandler=function(b,d){return c(a.globalValueHandlers,b,d)},a.Cloneable=function(){function a(){}return a.prototype.clone=function(){var a;return a=new this.constructor,e(a,JSON.parse(JSON.stringify(this)))},a}(),a.BaseBuilder=function(d){function f(b){var c;c=JSON.parse(JSON.stringify(a.DefaultQueryBuilderOptions)),this.options=e({},c,b)}return n(f,d),f.prototype.registerValueHandler=function(a,b){return c(this.options.valueHandlers,a,b),this},f.prototype._getObjectClassName=function(a){var b;return a&&a.constructor&&a.constructor.toString&&(b=a.constructor.toString().match(/function\s*(\w+)/),b&&2===b.length)?b[1]:void 0},f.prototype._sanitizeCondition=function(b){if(b instanceof a.Expression&&(b=b.toString()),"string"!=typeof b)throw new Error("condition must be a string or Expression instance");return b},f.prototype._sanitizeName=function(a,b){if("string"!=typeof a)throw new Error(""+b+" must be a string");return a},f.prototype._sanitizeField=function(b,c){var d;return null==c&&(c={}),b instanceof a.QueryBuilder?b="("+b+")":(b=this._sanitizeName(b,"field name"),this.options.autoQuoteFieldNames&&(d=this.options.nameQuoteCharacter,b=c.ignorePeriodsForFieldNameQuotes?""+d+b+d:b.split(".").map(function(a){return"*"===a?a:""+d+a+d}).join("."))),b},f.prototype._sanitizeTable=function(b,c){var d;if(null==c&&(c=!1),c){if("string"!=typeof b){if(b instanceof a.QueryBuilder&&b.isNestable())return b;throw new Error("table name must be a string or a nestable query instance")}d=b}else d=this._sanitizeName(b,"table name");return this.options.autoQuoteTableNames?""+this.options.nameQuoteCharacter+d+this.options.nameQuoteCharacter:d},f.prototype._sanitizeTableAlias=function(a){var b;return b=this._sanitizeName(a,"table alias"),this.options.autoQuoteAliasNames?""+this.options.tableAliasQuoteCharacter+b+this.options.tableAliasQuoteCharacter:b},f.prototype._sanitizeFieldAlias=function(a){var b;return b=this._sanitizeName(a,"field alias"),this.options.autoQuoteAliasNames?""+this.options.fieldAliasQuoteCharacter+b+this.options.fieldAliasQuoteCharacter:b},f.prototype._sanitizeLimitOffset=function(a){if(a=parseInt(a),0>a||isNaN(a))throw new Error("limit/offset must be >= 0");return a},f.prototype._sanitizeValue=function(c){var d,e;if(d=typeof c,null===c);else if("string"===d||"number"===d||"boolean"===d);else if(c instanceof a.QueryBuilder&&c.isNestable());else if(e=void 0!==b(c,this.options.valueHandlers,a.globalValueHandlers),!e)throw new Error("field value must be a string, number, boolean, null or one of the registered custom value types");return c},f.prototype._escapeValue=function(a){return!0!==this.options.replaceSingleQuotes?a:a.replace(/\'/g,this.options.singleQuoteReplacement)},f.prototype._formatCustomValue=function(c){var d;return d=b(c,this.options.valueHandlers,a.globalValueHandlers),d&&(c=d(c)),c},f.prototype._formatValueAsParam=function(b){return b instanceof a.QueryBuilder&&b.isNestable()?""+b:this._formatCustomValue(b)},f.prototype._formatValue=function(b,c){return null==c&&(c={}),b=this._formatCustomValue(b),null===b?b="NULL":"boolean"==typeof b?b=b?"TRUE":"FALSE":b instanceof a.QueryBuilder?b="("+b+")":"number"!=typeof b&&(b=this._escapeValue(b),b=c.dontQuote?""+b:"'"+b+"'"),b},f}(a.Cloneable),a.Expression=function(a){function b(){var a=this;b.__super__.constructor.call(this),this.tree={parent:null,nodes:[]},this.current=this.tree,this._begin=function(b){var c;return c={type:b,parent:a.current,nodes:[]},a.current.nodes.push(c),a.current=a.current.nodes[a.current.nodes.length-1],a}}return n(b,a),b.prototype.tree=null,b.prototype.current=null,b.prototype.and_begin=function(){return this._begin("AND")},b.prototype.or_begin=function(){return this._begin("OR")},b.prototype.end=function(){if(!this.current.parent)throw new Error("begin() needs to be called");return this.current=this.current.parent,this},b.prototype.and=function(a,b){if(!a||"string"!=typeof a)throw new Error("expr must be a string");return this.current.nodes.push({type:"AND",expr:a,para:b}),this},b.prototype.or=function(a,b){if(!a||"string"!=typeof a)throw new Error("expr must be a string");return this.current.nodes.push({type:"OR",expr:a,para:b}),this},b.prototype.toString=function(){if(null!==this.current.parent)throw new Error("end() needs to be called");return this._toString(this.tree)},b.prototype.toParam=function(){if(null!==this.current.parent)throw new Error("end() needs to be called");return this._toString(this.tree,!0)},b.prototype._toString=function(a,b){var c,d,e,f,g,h,i,j,k,l,m;for(null==b&&(b=!1),g="",f=[],l=a.nodes,h=0,j=l.length;j>h;h++){if(c=l[h],null!=c.expr){if(d=c.expr,null!=c.para)if(b)if(Array.isArray(c.para))for(m=c.para,i=0,k=m.length;k>i;i++)e=m[i],f.push(this._formatValueAsParam(e));else f.push(this._formatValueAsParam(c.para));else c.para=Array.isArray(c.para)?"("+c.para.join(", ")+")":this._formatValue(c.para),d=d.replace("?",c.para)}else d=this._toString(c,b),b&&(f=f.concat(d.values),d=d.text),""!==d&&(d="("+d+")");""!==d&&(""!==g&&(g+=" "+c.type+" "),g+=d)}return b?{text:g,values:f}:g},b.prototype.clone=function(){var a,b;return a=new this.constructor,(b=function(c){var d,e,f,g,h;for(g=c.nodes,h=[],e=0,f=g.length;f>e;e++)d=g[e],null!=d.expr?h.push(a.current.nodes.push(JSON.parse(JSON.stringify(d)))):(a._begin(d.type),b(d),h.push(!this.current===d?a.end():void 0));return h})(this.tree),a},b}(a.BaseBuilder),a.Block=function(b){function c(){return f=c.__super__.constructor.apply(this,arguments)}return n(c,b),c.prototype.exposedMethods=function(){var b,c,d;c={};for(b in this)d=this[b],"function"!=typeof d||"_"===b.charAt(0)||a.Block.prototype[b]||(c[b]=d);return c},c.prototype.buildStr=function(){return""},c.prototype.buildParam=function(a){return{text:this.buildStr(a),values:[]}},c}(a.BaseBuilder),a.StringBlock=function(a){function b(a,c){b.__super__.constructor.call(this,a),this.str=c}return n(b,a),b.prototype.buildStr=function(){return this.str},b}(a.Block),a.AbstractTableBlock=function(a){function b(a){b.__super__.constructor.call(this,a),this.tables=[]}return n(b,a),b.prototype._table=function(a,b){return null==b&&(b=null),b&&(b=this._sanitizeTableAlias(b)),a=this._sanitizeTable(a,this.options.allowNested||!1),this.options.singleTable&&(this.tables=[]),this.tables.push({table:a,alias:b})},b.prototype.buildStr=function(){var a,b,c,d,e;if(0>=this.tables.length)throw new Error("_table() needs to be called");for(b="",e=this.tables,c=0,d=e.length;d>c;c++)a=e[c],""!==b&&(b+=", "),b+="string"==typeof a.table?a.table:"("+a.table+")",a.alias&&(b+=" "+a.alias);return b},b}(a.Block),a.UpdateTableBlock=function(a){function b(){return g=b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.table=function(a,b){return null==b&&(b=null),this._table(a,b)},b}(a.AbstractTableBlock),a.FromTableBlock=function(a){function b(){return h=b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.from=function(a,b){return null==b&&(b=null),this._table(a,b)},b.prototype.buildStr=function(a){var c;if(0>=this.tables.length)throw new Error("from() needs to be called");return c=b.__super__.buildStr.call(this,a),"FROM "+c},b}(a.AbstractTableBlock),a.IntoTableBlock=function(a){function b(a){b.__super__.constructor.call(this,a),this.table=null}return n(b,a),b.prototype.into=function(a){return this.table=this._sanitizeTable(a,!1)},b.prototype.buildStr=function(){if(!this.table)throw new Error("into() needs to be called");return"INTO "+this.table},b}(a.Block),a.GetFieldBlock=function(a){function b(a){b.__super__.constructor.call(this,a),this._fields=[]}return n(b,a),b.prototype.fields=function(a,b){var c,d,e;null==b&&(b={}),e=[];for(d in a)c=a[d],e.push(this.field(d,c,b));return e},b.prototype.field=function(a,b,c){return null==b&&(b=null),null==c&&(c={}),a=this._sanitizeField(a,c),b&&(b=this._sanitizeFieldAlias(b)),this._fields.push({name:a,alias:b})},b.prototype.buildStr=function(){var a,b,c,d,e;for(b="",e=this._fields,c=0,d=e.length;d>c;c++)a=e[c],""!==b&&(b+=", "),b+=a.name,a.alias&&(b+=" AS "+a.alias);return""===b?"*":b},b}(a.Block),a.AbstractSetFieldBlock=function(a){function b(a){b.__super__.constructor.call(this,a),this.fieldOptions=[],this.fields=[],this.values=[]}return n(b,a),b.prototype._set=function(a,b,c){var d;if(null==c&&(c={}),this.values.length>1)throw new Error("Cannot call set or setFields on multiple rows of fields.");return void 0!==b&&(b=this._sanitizeValue(b)),d=this.fields.indexOf(this._sanitizeField(a,c)),-1!==d?(this.values[0][d]=b,this.fieldOptions[0][d]=c):(this.fields.push(this._sanitizeField(a,c)),d=this.fields.length-1,Array.isArray(this.values[0])?(this.values[0][d]=b,this.fieldOptions[0][d]=c):(this.values.push([b]),this.fieldOptions.push([c]))),this},b.prototype._setFields=function(a,b){var c;if(null==b&&(b={}),"object"!=typeof a)throw new Error("Expected an object but got "+typeof a);for(c in a)m.call(a,c)&&this._set(c,a[c],b);return this},b.prototype._setFieldsRows=function(a,b){var c,d,e,f,g,h,i;if(null==b&&(b={}),!Array.isArray(a))throw new Error("Expected an array of objects but got "+typeof a);for(this.fields=[],this.values=[],d=g=0,h=a.length;h>=0?h>g:g>h;d=h>=0?++g:--g){i=a[d];for(c in i)if(m.call(i,c)){if(e=this.fields.indexOf(this._sanitizeField(c,b)),d>0&&-1===e)throw new Error("All fields in subsequent rows must match the fields in the first row");-1===e&&(this.fields.push(this._sanitizeField(c,b)),e=this.fields.length-1),f=this._sanitizeValue(a[d][c]),Array.isArray(this.values[d])?(this.values[d][e]=f,this.fieldOptions[d][e]=b):(this.values[d]=[f],this.fieldOptions[d]=[b])}}return this},b.prototype.buildStr=function(){throw new Error("Not yet implemented")},b.prototype.buildParam=function(){throw new Error("Not yet implemented")},b}(a.Block),a.SetFieldBlock=function(a){function b(){return i=b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.set=function(a,b,c){return this._set(a,b,c)},b.prototype.setFields=function(a,b){return this._setFields(a,b)},b.prototype.buildStr=function(){var a,b,c,d,e,f,g;if(0>=this.fields.length)throw new Error("set() needs to be called");for(d="",c=f=0,g=this.fields.length;g>=0?g>f:f>g;c=g>=0?++f:--f)a=this.fields[c],""!==d&&(d+=", "),e=this.values[0][c],b=this.fieldOptions[0][c],d+="undefined"==typeof e?a:""+a+" = "+this._formatValue(e,b);return"SET "+d},b.prototype.buildParam=function(){var a,b,c,d,e,f,g;if(0>=this.fields.length)throw new Error("set() needs to be called");for(c="",d=[],b=f=0,g=this.fields.length;g>=0?g>f:f>g;b=g>=0?++f:--f)a=this.fields[b],""!==c&&(c+=", "),e=this.values[0][b],"undefined"==typeof e?c+=a:(c+=""+a+" = ?",d.push(this._formatValueAsParam(e)));return{text:"SET "+c,values:d}},b}(a.AbstractSetFieldBlock),a.InsertFieldValueBlock=function(a){function b(){return j=b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.set=function(a,b,c){return null==c&&(c={}),this._set(a,b,c)},b.prototype.setFields=function(a,b){return this._setFields(a,b)},b.prototype.setFieldsRows=function(a,b){return this._setFieldsRows(a,b)},b.prototype.buildStr=function(){var a,b,c,d,e,f,g,h;if(0>=this.fields.length)throw new Error("set() needs to be called");for(d=[],b=e=0,g=this.values.length;g>=0?g>e:e>g;b=g>=0?++e:--e)for(c=f=0,h=this.values[b].length;h>=0?h>f:f>h;c=h>=0?++f:--f)a=this._formatValue(this.values[b][c],this.fieldOptions[b][c]),"string"==typeof d[b]?d[b]+=", "+a:d[b]=""+a;return"("+this.fields.join(", ")+") VALUES ("+d.join("), (")+")"},b.prototype.buildParam=function(){var a,b,c,d,e,f,g,h,i,j,k;if(0>=this.fields.length)throw new Error("set() needs to be called");for(d="",e=[],c=[],a=f=0,i=this.fields.length;i>=0?i>f:f>i;a=i>=0?++f:--f)""!==d&&(d+=", "),d+=this.fields[a];for(a=g=0,j=this.values.length;j>=0?j>g:g>j;a=j>=0?++g:--g)for(b=h=0,k=this.values[a].length;k>=0?k>h:h>k;b=k>=0?++h:--h)c.push(this._formatValueAsParam(this.values[a][b])),"string"==typeof e[a]?e[a]+=", ?":e[a]="?";return{text:"("+d+") VALUES ("+e.join("), (")+")",values:c}},b}(a.AbstractSetFieldBlock),a.DistinctBlock=function(a){function b(a){b.__super__.constructor.call(this,a),this.useDistinct=!1}return n(b,a),b.prototype.distinct=function(){return this.useDistinct=!0},b.prototype.buildStr=function(){return this.useDistinct?"DISTINCT":""},b}(a.Block),a.GroupByBlock=function(a){function b(a){b.__super__.constructor.call(this,a),this.groups=[]}return n(b,a),b.prototype.group=function(a){return a=this._sanitizeField(a),this.groups.push(a)},b.prototype.buildStr=function(){var a,b,c,d,e;if(b="",0<this.groups.length){for(e=this.groups,c=0,d=e.length;d>c;c++)a=e[c],""!==b&&(b+=", "),b+=a;b="GROUP BY "+b}return b},b}(a.Block),a.OffsetBlock=function(a){function b(a){b.__super__.constructor.call(this,a),this.offsets=null}return n(b,a),b.prototype.offset=function(a){return a=this._sanitizeLimitOffset(a),this.offsets=a},b.prototype.buildStr=function(){return this.offsets?"OFFSET "+this.offsets:""},b}(a.Block),a.WhereBlock=function(a){function b(a){b.__super__.constructor.call(this,a),this.wheres=[]}return n(b,a),b.prototype.where=function(){var a,b,c,d,e,f,g,h,i,j,k,m,n;for(b=arguments[0],i=2<=arguments.length?l.call(arguments,1):[],b=this._sanitizeCondition(b),c="",d=[],e=j=0,n=b.length;n>=0?n>j:j>n;e=n>=0?++j:--j)if(a=b.charAt(e),"?"===a&&0<i.length)if(h=i.shift(),Array.isArray(h)){for(f=[],k=0,m=h.length;m>k;k++)g=h[k],f.push(this._sanitizeValue(g));d=d.concat(f),c+="("+function(){var a,b,c;for(c=[],a=0,b=f.length;b>a;a++)g=f[a],c.push("?");return c}().join(", ")+")"}else c+="?",d.push(this._sanitizeValue(h));else c+=a;return""!==c?this.wheres.push({text:c,values:d}):void 0},b.prototype.buildStr=function(){var a,b,c,d,e,f,g,h,i,j;if(0>=this.wheres.length)return"";for(e="",i=this.wheres,f=0,h=i.length;h>f;f++)if(d=i[f],""!==e&&(e+=") AND ("),0<d.values.length)for(c=0,b=g=0,j=d.text.length;j>=0?j>g:g>j;b=j>=0?++g:--g)a=d.text.charAt(b),e+="?"===a?this._formatValue(d.values[c++]):a;else e+=d.text;return"WHERE ("+e+")"},b.prototype.buildParam=function(){var a,b,c,d,e,f,g,h,i,j,k;if(a={text:"",values:[]},0>=this.wheres.length)return a;for(e="",j=this.wheres,f=0,h=j.length;h>f;f++)for(d=j[f],""!==e&&(e+=") AND ("),e+=d.text,k=d.values,g=0,i=k.length;i>g;g++)b=k[g],a.values.push(this._formatValueAsParam(b)),c=this._formatValueAsParam(c);return a.text="WHERE ("+e+")",a},b}(a.Block),a.OrderByBlock=function(a){function b(a){b.__super__.constructor.call(this,a),this.orders=[]}return n(b,a),b.prototype.order=function(a,b){return null==b&&(b=!0),a=this._sanitizeField(a),this.orders.push({field:a,dir:b?!0:!1})},b.prototype.buildStr=function(){var a,b,c,d,e;if(0<this.orders.length){for(b="",e=this.orders,c=0,d=e.length;d>c;c++)a=e[c],""!==b&&(b+=", "),b+=""+a.field+" "+(a.dir?"ASC":"DESC");return"ORDER BY "+b}return""},b}(a.Block),a.LimitBlock=function(a){function b(a){b.__super__.constructor.call(this,a),this.limits=null}return n(b,a),b.prototype.limit=function(a){return a=this._sanitizeLimitOffset(a),this.limits=a},b.prototype.buildStr=function(){return this.limits?"LIMIT "+this.limits:""},b}(a.Block),a.JoinBlock=function(a){function b(a){b.__super__.constructor.call(this,a),this.joins=[]}return n(b,a),b.prototype.join=function(a,b,c,d){return null==b&&(b=null),null==c&&(c=null),null==d&&(d="INNER"),a=this._sanitizeTable(a,!0),b&&(b=this._sanitizeTableAlias(b)),c&&(c=this._sanitizeCondition(c)),this.joins.push({type:d,table:a,alias:b,condition:c}),this},b.prototype.left_join=function(a,b,c){return null==b&&(b=null),null==c&&(c=null),this.join(a,b,c,"LEFT")},b.prototype.right_join=function(a,b,c){return null==b&&(b=null),null==c&&(c=null),this.join(a,b,c,"RIGHT")},b.prototype.outer_join=function(a,b,c){return null==b&&(b=null),null==c&&(c=null),this.join(a,b,c,"OUTER")},b.prototype.left_outer_join=function(a,b,c){return null==b&&(b=null),null==c&&(c=null),this.join(a,b,c,"LEFT OUTER")},b.prototype.buildStr=function(){var a,b,c,d,e;for(b="",e=this.joins||[],c=0,d=e.length;d>c;c++)a=e[c],""!==b&&(b+=" "),b+=""+a.type+" JOIN ",b+="string"==typeof a.table?a.table:"("+a.table+")",a.alias&&(b+=" "+a.alias),a.condition&&(b+=" ON ("+a.condition+")");return b},b}(a.Block),a.QueryBuilder=function(a){function b(a,c){var d,e,f,g,h,i,j,k,l=this;for(b.__super__.constructor.call(this,a),this.blocks=c||[],j=this.blocks,h=0,i=j.length;i>h;h++){d=j[h],k=d.exposedMethods(),g=function(a,b,c){return l[b]=function(){return c.apply(a,arguments),l}};for(f in k){if(e=k[f],null!=this[f])throw new Error(""+this._getObjectClassName(this)+" already has a builder method called: "+f);g(d,f,e)}}}return n(b,a),b.prototype.registerValueHandler=function(a,c){var d,e,f,g;for(g=this.blocks,e=0,f=g.length;f>e;e++)d=g[e],d.registerValueHandler(a,c);return b.__super__.registerValueHandler.call(this,a,c),this},b.prototype.updateOptions=function(a){var b,c,d,f,g;for(this.options=e({},this.options,a),f=this.blocks,g=[],c=0,d=f.length;d>c;c++)b=f[c],g.push(b.options=e({},b.options,a));return g},b.prototype.toString=function(){var a;return function(){var b,c,d,e;for(d=this.blocks,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.buildStr(this));return e}.call(this).filter(function(a){return 0<a.length}).join(this.options.separator)},b.prototype.toParam=function(){var a,b,c,d,e;return d={text:"",values:[]},b=function(){var b,c,d,e;for(d=this.blocks,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.buildParam(this));return e}.call(this),d.text=function(){var c,d,e;for(e=[],c=0,d=b.length;d>c;c++)a=b[c],e.push(a.text);return e}().filter(function(a){return 0<a.length}).join(this.options.separator),d.values=(e=[]).concat.apply(e,function(){var c,d,e;for(e=[],c=0,d=b.length;d>c;c++)a=b[c],e.push(a.values);return e}()),this.options.numberedParameters&&(c=0,d.text=d.text.replace(/\?/g,function(){return"$"+ ++c})),d},b.prototype.clone=function(){var a;return new this.constructor(this.options,function(){var b,c,d,e;for(d=this.blocks,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.clone());return e}.call(this))},b.prototype.isNestable=function(){return!1},b}(a.BaseBuilder),a.Select=function(b){function c(b,d){null==d&&(d=null),d||(d=[new a.StringBlock(b,"SELECT"),new a.DistinctBlock(b),new a.GetFieldBlock(b),new a.FromTableBlock(e({},b,{allowNested:!0})),new a.JoinBlock(e({},b,{allowNested:!0})),new a.WhereBlock(b),new a.GroupByBlock(b),new a.OrderByBlock(b),new a.LimitBlock(b),new a.OffsetBlock(b)]),c.__super__.constructor.call(this,b,d)}return n(c,b),c.prototype.isNestable=function(){return!0},c}(a.QueryBuilder),a.Update=function(b){function c(b,d){null==d&&(d=null),d||(d=[new a.StringBlock(b,"UPDATE"),new a.UpdateTableBlock(b),new a.SetFieldBlock(b),new a.WhereBlock(b),new a.OrderByBlock(b),new a.LimitBlock(b)]),c.__super__.constructor.call(this,b,d)}return n(c,b),c}(a.QueryBuilder),a.Delete=function(b){function c(b,d){null==d&&(d=null),d||(d=[new a.StringBlock(b,"DELETE"),new a.FromTableBlock(e({},b,{singleTable:!0})),new a.JoinBlock(b),new a.WhereBlock(b),new a.OrderByBlock(b),new a.LimitBlock(b)]),c.__super__.constructor.call(this,b,d)}return n(c,b),c}(a.QueryBuilder),a.Insert=function(b){function c(b,d){null==d&&(d=null),d||(d=[new a.StringBlock(b,"INSERT"),new a.IntoTableBlock(b),new a.InsertFieldValueBlock(b)]),c.__super__.constructor.call(this,b,d)}return n(c,b),c}(a.QueryBuilder),d={VERSION:"3.6.0",expr:function(){return new a.Expression},select:function(b,c){return new a.Select(b,c)},update:function(b,c){return new a.Update(b,c)},insert:function(b,c){return new a.Insert(b,c)},"delete":function(b,c){return new a.Delete(b,c)},registerValueHandler:a.registerValueHandler},d.remove=d["delete"],d.cls=a,("undefined"!=typeof define&&null!==define?define.amd:void 0)?define(function(){return d}):("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=d:"undefined"!=typeof window&&null!==window&&(window.squel=d),d.flavours={},d.useFlavour=function(a){if(!(d.flavours[a]instanceof Function))throw new Error("Flavour not available: "+a);return d.flavours[a].call(null,d),d},d.flavours.postgres=function(){return a=d.cls,a.DefaultQueryBuilderOptions.numberedParameters=!0,a.ReturningBlock=function(a){function b(a){b.__super__.constructor.call(this,a),this._str=null}return n(b,a),b.prototype.returning=function(a){return this._str=this._sanitizeField(a)},b.prototype.buildStr=function(){return this._str?"RETURNING "+this._str:""},b}(a.Block),a.Insert=function(b){function c(b,d){null==d&&(d=null),d||(d=[new a.StringBlock(b,"INSERT"),new a.IntoTableBlock(b),new a.InsertFieldValueBlock(b),new a.ReturningBlock(b)]),c.__super__.constructor.call(this,b,d)}return n(c,b),c}(a.QueryBuilder),a.Update=function(b){function c(b,d){null==d&&(d=null),d||(d=[new a.StringBlock(b,"UPDATE"),new a.UpdateTableBlock(b),new a.SetFieldBlock(b),new a.WhereBlock(b),new a.OrderByBlock(b),new a.LimitBlock(b),new a.ReturningBlock(b)]),c.__super__.constructor.call(this,b,d)}return n(c,b),c}(a.QueryBuilder),a.Delete=function(b){function c(b,d){null==d&&(d=null),d||(d=[new a.StringBlock(b,"DELETE"),new a.FromTableBlock(e({},b,{singleTable:!0})),new a.JoinBlock(b),new a.WhereBlock(b),new a.OrderByBlock(b),new a.LimitBlock(b),new a.ReturningBlock(b)]),c.__super__.constructor.call(this,b,d)}return n(c,b),c}(a.QueryBuilder)},d.flavours.mysql=function(){var b;return a=d.cls,a.MysqlOnDuplicateKeyUpdateBlock=function(a){function c(){return b=c.__super__.constructor.apply(this,arguments)}return n(c,a),c.prototype.onDupUpdate=function(a,b,c){return this._set(a,b,c)},c.prototype.buildStr=function(){var a,b,c,d,e,f,g;for(d="",c=f=0,g=this.fields.length;g>=0?g>f:f>g;c=g>=0?++f:--f)a=this.fields[c],""!==d&&(d+=", "),e=this.values[0][c],b=this.fieldOptions[0][c],d+="undefined"==typeof e?a:""+a+" = "+this._formatValue(e,b);return""===d?"":"ON DUPLICATE KEY UPDATE "+d},c.prototype.buildParam=function(){var a,b,c,d,e,f,g;for(c="",d=[],b=f=0,g=this.fields.length;g>=0?g>f:f>g;b=g>=0?++f:--f)a=this.fields[b],""!==c&&(c+=", "),e=this.values[0][b],"undefined"==typeof e?c+=a:(c+=""+a+" = ?",d.push(this._formatValueAsParam(e)));return{text:""===c?"":"ON DUPLICATE KEY UPDATE "+c,values:d}},c}(a.AbstractSetFieldBlock),a.Insert=function(b){function c(b,d){null==d&&(d=null),d||(d=[new a.StringBlock(b,"INSERT"),new a.IntoTableBlock(b),new a.InsertFieldValueBlock(b),new a.MysqlOnDuplicateKeyUpdateBlock(b)]),c.__super__.constructor.call(this,b,d)}return n(c,b),c}(a.QueryBuilder)}}).call(this);